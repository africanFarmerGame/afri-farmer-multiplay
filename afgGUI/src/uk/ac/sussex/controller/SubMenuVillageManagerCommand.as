package uk.ac.sussex.controller {	import uk.ac.sussex.model.valueObjects.AssetAmount;	import uk.ac.sussex.model.valueObjects.GameAsset;	import uk.ac.sussex.general.ApplicationFacade;	import uk.ac.sussex.model.*;	import uk.ac.sussex.model.valueObjects.VillageOverview;	import uk.ac.sussex.serverhandlers.VillageHandlers;	import uk.ac.sussex.view.*;	import org.puremvc.as3.multicore.interfaces.INotification;	import org.puremvc.as3.multicore.patterns.command.SimpleCommand;	/**	 * @author em97	 */	public class SubMenuVillageManagerCommand extends SimpleCommand {		override public function execute( note:INotification ):void {						var subMenuItem:String = note.getBody() as String;			trace("SubMenuVillageCommand sez: Trying to fire off " + subMenuItem);						switch(subMenuItem){				case VillageHandlers.SUB_MENU_OVERVIEW:					displayVillageOverview();					showVillage(true);					showGiveForm(false);					showResForm(false);					break;				case VillageHandlers.SUB_MENU_LIKE:					sendNotification(ApplicationFacade.DISPLAY_INFO_TEXT, "Like");					break;				case VillageHandlers.SUB_MENU_GIVE:					var giveMessage:String = "Give";					giveMessage += "\n\n This allows you to give things to anyone in the village.";					giveMessage += "\n As the game manager you have infinite supplies.";					sendNotification(ApplicationFacade.DISPLAY_INFO_TEXT, giveMessage);					showVillage(false);					showGiveForm(true);					showResForm(false);					break;				case VillageHandlers.SUB_MENU_RESURRECT:					var resMessage:String = "Resurrection";					resMessage += "\n\nHere you can resurrect any characters who have been lost to malnutrition or misadventure. Any death duties will also be paid off.";					resMessage += "\n\nThis should be used sparingly, if possible. ";					sendNotification(ApplicationFacade.DISPLAY_INFO_TEXT, resMessage);					showVillage(false);					showGiveForm(false);					showResForm(true);					break;			}		}		private function showVillage(show:Boolean):void {		  	var hearthListProxy:HearthListProxy = facade.retrieveProxy(HearthListProxy.NAME) as HearthListProxy;	  		if(hearthListProxy!=null){				var hearthlist:Array = hearthListProxy.getHearthIds();				for each (var hearthId:int in hearthlist){					var hearthMediator:HearthMediator = facade.retrieveMediator(HearthMediator.NAME + hearthId) as HearthMediator;				  	if(hearthMediator != null){				  		hearthMediator.displayHearth(show);					}			  	}			}		}		private function showGiveForm(show:Boolean):void {			var formMediator:FormMediator = facade.retrieveMediator(VillageHandlers.GIVE_FORM) as FormMediator;			if(formMediator!=null){		    	trace("SubMenuVillageCommand sez: FormMediator isn't null");		    	if(show){		    		formMediator.addToViewArea();		    	} else {		    		formMediator.hideForm();				}			} else {	      		trace("SubMenuVillageCommand sez: FormMediator is null");	    	}			//For the manager this needs to be stocked with anything that is available in game.		    var assetListMediator:InStockAssetListMediator = facade.retrieveMediator(InStockAssetListMediator.NAME) as InStockAssetListMediator;		    if(assetListMediator!=null){				if(show){					//var hearthAssetsLP:HearthAssetListProxy = facade.retrieveProxy(HearthAsset.OWNER_HEARTH + HearthAssetListProxy.NAME) as HearthAssetListProxy;					var gameAssetsLP:GameAssetListProxy = facade.retrieveProxy(GameAssetListProxy.NAME) as GameAssetListProxy; 					if(gameAssetsLP!= null){						var assetArray:Array = new Array();						var gameAssets:Array = gameAssetsLP.getAllGameAssets();						for each (var ga:GameAsset in gameAssets){							var asset:AssetAmount = new AssetAmount();							asset.setAsset(ga);							asset.setAmount(300);							assetArray.push(asset);						}						assetListMediator.setContents(assetArray);					}					assetListMediator.setListTitle("Game Assets");				}	    		assetListMediator.showList(show);	    	}		}		private function showResForm(show:Boolean):void {			var formMediator:FormMediator = facade.retrieveMediator(VillageHandlers.RES_FORM) as FormMediator;			if(formMediator!=null){				if(show){					formMediator.addToViewArea();				} else {					formMediator.hideForm();				}			}		}		private function displayVillageOverview():void {			var villageOverviewProxy:VillageOverviewProxy = facade.retrieveProxy(VillageOverviewProxy.NAME) as VillageOverviewProxy;			if(villageOverviewProxy == null) {				//Issue.	      	} else {		        var villageOverview:VillageOverview = villageOverviewProxy.getVillageOverview();		        var villageTitle:String = villageOverview.getName() + " Village";	  			var households:String = "Number of households: " + villageOverview.getHouseholds();	  			var adults:String = "Number of adults: " + villageOverview.getNumAdults();	  			var children:String = "Number of children: " + villageOverview.getNumKids();		  			var totalText:String = villageTitle + "\n\n" + households + "\n" + adults + "\n" + children;				totalText += "\n\nIf you need to, you can have a look around the villagers' houses to get a better view of what they are up to. Click on a hearth door to enter.";				totalText += " To view their farms, click on the farm icon from their hearth screens. Leave their home by returning to any of the communal areas.";		  			sendNotification(ApplicationFacade.DISPLAY_INFO_TEXT, totalText);	    	}		}	}}