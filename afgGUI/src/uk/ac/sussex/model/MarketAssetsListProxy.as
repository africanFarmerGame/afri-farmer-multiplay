package uk.ac.sussex.model {	import uk.ac.sussex.model.valueObjects.MarketAsset;	import org.puremvc.as3.multicore.interfaces.IProxy;	import org.puremvc.as3.multicore.patterns.proxy.Proxy;		public class MarketAssetsListProxy extends Proxy implements IProxy {		public static const NAME:String = "MarketAssetsListProxy";		public static const ASSET_ADDED:String = "MarketAssetAdded";		public static const ASSET_UPDATED:String = "MarketAssetUpdated";				public function MarketAssetsListProxy() {			data = new Array();			super(NAME, data);		}		public function addAsset(newAsset:MarketAsset):void {			trace("MarketAssetsListProxy sez: We're adding an asset - " + newAsset.getAsset().getName());			var foundAsset:Boolean = false;			var newMAId:int = newAsset.getId();			for each (var ma:MarketAsset in maList){				if(!foundAsset){					foundAsset = (ma.getId() == newMAId);				}			}			if(!foundAsset){				maList.push(newAsset);			} else {				this.updateAsset(ma);			}			sendNotification(ASSET_ADDED, newAsset);		}		public function getAssetCount():int {			return this.maList.length;		}		public function fetchAssets():Array {			return maList.sort(sortOnAssetName);		}		public function updateAsset(ma:MarketAsset):void {			var assetId:int = ma.getId();			for each (var asset:MarketAsset in maList){				if(asset.getId()==assetId){					//What's actually likely to have changed?					asset.setAmount(ma.getAmount());					asset.setBuyPrice(ma.getBuyPrice());					asset.setSellPrice(ma.getSellPrice());					sendNotification(ASSET_UPDATED, asset);					break;				}			}		}		public function getAsset(assetId:int):MarketAsset{			for each (var asset:MarketAsset in maList){				if(asset.getId()==assetId){					return asset;				}			}			return null;		}		public function getMarketAssetByAssetId(gameAssetId:int):MarketAsset{			for each (var marketAsset:MarketAsset in maList){				if(marketAsset.getAsset().getId() == gameAssetId){					return marketAsset;				}			}		}		protected function get maList():Array {			return data as Array;		}		private function sortOnAssetName(a:MarketAsset, b:MarketAsset):int {			if(a.getAsset()==null || b.getAsset()==null){				return 0;			}			var aName:String = a.getAsset().getName();			var bName:String = b.getAsset().getName();			if(aName>bName){				return 1;			} else if (aName<bName) {				return -1;			} else {				return 0;			}		}	}}